{% extends "base.html" %}
{% load staticfiles %}

<body>
	<div id="chartContainer" style="width:100%; height:300px;"></div>

{% block content %}

  <p id="demo"></p>
  <p id="d2"></p>

  <script>
    var TD = window.location.href.split("/")
    var ID = TD[TD.length-2]
    var subpage = TD[TD.length-1]
    document.getElementById("demo").innerHTML = "ID#:<br>" + ID;
    document.getElementById("d2").innerHTML = "Results for:<br>" + subpage;
  </script>
  
  <button onclick="goBack()">Go Back</button>

  <script>
    function goBack() {
      window.history.back();
    }
  </script>

  {% comment %} https://canvasjs.com/html5-javascript-line-chart/ {% endcomment %}
  <div id="chartContainer" style="height: 370px; max-width: 920px; margin: 0px auto;"></div>
  <script src="https://canvasjs.com/assets/script/jquery-1.11.1.min.js"></script>
  <script src="https://canvasjs.com/assets/script/jquery.canvasjs.min.js"></script>

  <script>
    var dataPoints = [];
    
    function getDataPointsFromCSV(csv) {
        var dataPoints = csvLines = points = [];
        csvLines = csv.split(/[\r?\n|\r|\n]+/);
            
        for (var i = 0; i < csvLines.length; i++)
            if (csvLines[i].length > 0) {
                points = csvLines[i].split(",");
                dataPoints.push({ 
                    x: parseFloat(points[0]), 
                    y: parseFloat(points[1]) 		
          });
      }
        return dataPoints;
    }
      
    sample = "../uploads/" + ID + "/results1.csv";
    $.get(sample, function(data) {
        var chart = new CanvasJS.Chart("chartContainer", {
            title: {
          text: "Chart from CSV",
            },
            data: [{
          type: "line",
          dataPoints: getDataPointsFromCSV(data)
      }]
    });
        chart.render();
 
});
  </script>
{% endblock %}
