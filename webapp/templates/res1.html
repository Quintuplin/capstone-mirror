{% extends "base.html" %}
{% load staticfiles %}

<body>
	<div id="chartContainer" style="width:100%; height:300px;"></div>

{% block content %}

  <p id="demo"></p>
  <p id="d2"></p>

  <script>
    var TD = window.location.href.split("/")
    var ID = TD[TD.length-2]
    var subpage = TD[TD.length-1]
    document.getElementById("demo").innerHTML = "ID#:<br>" + ID;
    document.getElementById("d2").innerHTML = "Results for:<br>" + subpage;
  </script>
  
  <button onclick="goBack()">Go Back</button>

  <script>
    function goBack() {
      window.history.back();
    }
  </script>

  {% comment %} https://www.chartjs.org/docs/latest/getting-started/usage.html {% endcomment %}
  <canvas id="myChart" width="400" height="400"></canvas>
<script>
var dataPoints = [];
  function getDataPointsFromCSV(csv) {
      var dataPoints = csvLines = points = [];
      csvLines = csv.split(/[\r?\n|\r|\n]+/);
          
      for (var i = 0; i < csvLines.length; i++)
          if (csvLines[i].length > 0) {
              points = csvLines[i].split(",");
              dataPoints.push({ 
                  x: parseFloat(points[0]), 
                  y: parseFloat(points[1]) 		
        });
    }
      return dataPoints;
  }

var ctx = document.getElementById('myChart');
sample = "../uploads/" + ID + "/results1.csv";

$.get(sample, function(data) {
  var myChart = new Chart(ctx, {
      type: 'line',
      data: {
          labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
          datasets: [{
              label: '# of Votes',
              data: getDataPointsFromCSV(data),
              backgroundColor: [
                  'rgba(255, 99, 132, 0.2)',
                  'rgba(54, 162, 235, 0.2)',
                  'rgba(255, 206, 86, 0.2)',
                  'rgba(75, 192, 192, 0.2)',
                  'rgba(153, 102, 255, 0.2)',
                  'rgba(255, 159, 64, 0.2)'
              ],
              borderColor: [
                  'rgba(255, 99, 132, 1)',
                  'rgba(54, 162, 235, 1)',
                  'rgba(255, 206, 86, 1)',
                  'rgba(75, 192, 192, 1)',
                  'rgba(153, 102, 255, 1)',
                  'rgba(255, 159, 64, 1)'
              ],
              borderWidth: 1
          }]
      },
      options: {
          scales: {
              yAxes: [{
                  ticks: {
                      beginAtZero: true
                  }
              }]
          }
      }
  });
});
</script>
  {% comment %} <script>
    var dataPoints = [];
    
    function getDataPointsFromCSV(csv) {
        var dataPoints = csvLines = points = [];
        csvLines = csv.split(/[\r?\n|\r|\n]+/);
            
        for (var i = 0; i < csvLines.length; i++)
            if (csvLines[i].length > 0) {
                points = csvLines[i].split(",");
                dataPoints.push({ 
                    x: parseFloat(points[0]), 
                    y: parseFloat(points[1]) 		
          });
      }
        return dataPoints;
    }
      
    sample = "../uploads/" + ID + "/results1.csv";
    $.get(sample, function(data) {
        var chart = new CanvasJS.Chart("chartContainer", {
            title: {
          text: "Chart from CSV",
            },
            data: [{
          type: "line",
          dataPoints: getDataPointsFromCSV(data)
      }]
    });
        chart.render();
 
});
  </script> {% endcomment %}
{% endblock %}
